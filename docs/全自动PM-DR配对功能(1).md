  PRD: å…¨è‡ªåŠ¨PM-DRå‚ç›´ä»·å·®é…å¯¹ç›‘æ§ç³»ç»Ÿ

  ç‰ˆæœ¬: 2.0 (å…¨è‡ªåŠ¨æ–¹æ¡ˆ)
	
  æ—¥æœŸ: 2025-11-10

  ä½œè€…: Claude Code + PM-DRå›¢é˜Ÿ

  ---
  1. èƒŒæ™¯ä¸ç›®æ ‡

  1.1 é—®é¢˜é™ˆè¿°

  å½“å‰ç³»ç»Ÿå­˜åœ¨ä»¥ä¸‹é™åˆ¶ï¼š
  1.
  æ‰‹åŠ¨é…ç½®ç“¶é¢ˆï¼šéœ€è¦åœ¨config.yamlä¸­æ‰‹åŠ¨åˆ—å‡ºæ¯ä¸ªPMé—®é¢˜å’ŒDRåˆçº¦ï¼Œäººå·¥å·¥ä½œé‡å¤§
  2. æœºä¼šè¦†ç›–ä¸å…¨ï¼šåªèƒ½ç›‘æ§å·²é…ç½®çš„é…å¯¹ï¼Œé”™è¿‡è®¸å¤šæ½œåœ¨å¥—åˆ©æœºä¼š
  3. ç»´æŠ¤æˆæœ¬é«˜ï¼šå¸‚åœºå˜åŒ–æ—¶éœ€è¦æ‰‹åŠ¨æ›´æ–°é…ç½®ï¼Œåˆ°æœŸåˆçº¦éœ€è¦æ‰‹åŠ¨æ¸…ç†
  4. å“åº”é€Ÿåº¦æ…¢ï¼šæ–°ä¸Šçº¿çš„PMé—®é¢˜æ— æ³•åŠæ—¶å‘ç°å’Œç›‘æ§

  1.2 ç›®æ ‡

  æ„å»ºé›¶é…ç½®ã€å…¨è‡ªåŠ¨çš„PM-DRé…å¯¹ç›‘æ§ç³»ç»Ÿï¼š
  - è‡ªåŠ¨å‘ç°ï¼šå®æ—¶æ‰«æPolymarketå’ŒDeribitå¸‚åœºï¼Œè‡ªåŠ¨è¯†åˆ«æ‰€æœ‰å¯äº¤æ˜“çš„BTC/ETHä»·
  æ ¼é—®é¢˜
  - æ™ºèƒ½åŒ¹é…ï¼šåŸºäºè¡Œæƒä»·ã€åˆ°æœŸæ—¥ã€æµåŠ¨æ€§è‡ªåŠ¨ç”Ÿæˆæœ€ä¼˜PM-DRé…å¯¹
  - åŠ¨æ€ç›‘æ§ï¼šè‡ªåŠ¨ç®¡ç†ç›‘æ§å®ä¾‹ï¼Œåªç›‘æ§top Nä¸ªæœ€ä¼˜æœºä¼š
  - å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šè‡ªåŠ¨ç§»é™¤åˆ°æœŸã€æµåŠ¨æ€§æ¯ç«­æˆ–å¸‚åœºå…³é—­çš„é…å¯¹

  1.3 æˆåŠŸæŒ‡æ ‡

  | æŒ‡æ ‡      | ç›®æ ‡å€¼   | åº¦é‡æ–¹å¼                           |
  |---------|-------|--------------------------------|
  | æœºä¼šè¦†ç›–ç‡   | >90%  | (ç›‘æ§çš„PMé—®é¢˜æ•°) / (å¸‚åœºä¸Šæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„PMé—®é¢˜æ•°)
   |
  | æ–°æœºä¼šæ£€æµ‹å»¶è¿Ÿ | <5åˆ†é’Ÿ  | ä»PMé—®é¢˜ä¸Šçº¿åˆ°ç³»ç»Ÿå¼€å§‹ç›‘æ§çš„æ—¶é—´
   |
  | é…ç½®å·¥ä½œé‡   | 0æ¬¡/å¤©  | æ— éœ€æ‰‹åŠ¨æ·»åŠ æˆ–åˆ é™¤é…å¯¹                    |
  | ç›‘æ§å®¹é‡    | 20å¯¹å¹¶è¡Œ | åŒæ—¶ç›‘æ§çš„PM-DRé…å¯¹æ•°é‡                 |
  | ç³»ç»Ÿå¯ç”¨æ€§   | >99%  | æ’é™¤ç½‘ç»œæ•…éšœçš„è¿è¡Œæ—¶é—´å æ¯”                  |

  ---
  2. ç”¨æˆ·

 2.1 ç›®æ ‡ç”¨æˆ·

  1. é‡åŒ–ç ”ç©¶å‘˜ï¼šå¸Œæœ›å‘ç°å¹¶åˆ†ææ‰€æœ‰å¯èƒ½çš„å¥—åˆ©æœºä¼š
  2. äº¤æ˜“æ‰§è¡Œå›¢é˜Ÿï¼šéœ€è¦å®æ—¶ç›‘æ§topæœºä¼šå¹¶æ‰§è¡Œäº¤æ˜“
  3. é£æ§å›¢é˜Ÿï¼šå…³æ³¨æ•´ä½“æŒä»“åˆ†å¸ƒå’Œå¯¹å†²è¦†ç›–ç‡

  ---
  3. åŠŸèƒ½éœ€æ±‚

  3.1 è‡ªåŠ¨å¸‚åœºå‘ç° (Auto Market Discovery)

  3.1.1 Polymarket åˆçº¦æ‰«æå™¨

  åŠŸèƒ½æè¿°ï¼š
  - é€šè¿‡Gamma APIçš„/public-searchç«¯ç‚¹æœç´¢BTCå’ŒETHç›¸å…³çš„ä»·æ ¼é¢„æµ‹é—®é¢˜
  - ä½¿ç”¨å¤šå…³é”®è¯ç­–ç•¥ç¡®ä¿è¦†ç›–ç‡ï¼ˆå¦‚"BTC"ã€"Bitcoin"ã€"$100K"ã€"100000"ç­‰ï¼‰
  - è§£æé—®é¢˜æ–‡æœ¬ï¼Œæå–å…³é”®ä¿¡æ¯ï¼šstrikeä»·æ ¼ã€åˆ°æœŸæ—¥æœŸã€æ–¹å‘ï¼ˆabove/belowï¼‰

  æ•°æ®ç»“æ„ï¼š
  @dataclass
  class PMQuestion:
      question_id: str          # å¸‚åœºID
      question_text: str        # åŸå§‹é—®é¢˜æ–‡æœ¬
      yes_token_id: str
      no_token_id: str
      strike_price: float       # æå–çš„è¡Œæƒä»·
      expiry_timestamp: float   # æå–çš„åˆ°æœŸæ—¶é—´
      direction: Literal["above", "below"]
      volume_usd: float         # 24häº¤æ˜“é‡
      discovered_at: float      # å‘ç°æ—¶é—´

  è§£æè§„åˆ™ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰ï¼š
  patterns = [
      r"Will .* be above \$([0-9,]+) on (.+)\?",
      r".* > \$([0-9,]+) by (.+)",
      r".* above ([0-9,]+)K on (.+)",
      r"Bitcoin price > \$([0-9,]+) - (.+)",
  ]

  è¿‡æ»¤æ¡ä»¶ï¼š
  - 24å°æ—¶äº¤æ˜“é‡ > $10,000
  - å‰©ä½™åˆ°æœŸæ—¶é—´ï¼š1-30å¤©
  - åªä¿ç•™"above"ç±»å‹ï¼ˆå¯¹åº”call spreadï¼‰

  æ›´æ–°é¢‘ç‡ï¼šæ¯5åˆ†é’Ÿå…¨é‡æ‰«æ

  3.1.2 Deribitåˆçº¦æ‰«æå™¨

  åŠŸèƒ½æè¿°ï¼š
  - è°ƒç”¨/public/get_instruments?currency=BTC&kind=option&expired=falseè·å–æ‰€
  æœ‰æ´»è·ƒæœŸæƒ
  - æŒ‰åˆ°æœŸæ—¥å’Œè¡Œæƒä»·åˆ†ç»„ï¼Œç”Ÿæˆå‚ç›´ä»·å·®ç»„åˆ
  - è¿‡æ»¤ä½æµåŠ¨æ€§åˆçº¦

  æ•°æ®ç»“æ„ï¼š
  @dataclass
  class DROption:
      instrument_name: str      # BTC_USDC-10NOV25-103000-C
      strike: float             # 103000
      expiry_timestamp: float
      option_type: Literal["call", "put"]
      open_interest: float      # æŒä»“é‡
      bid_price: float
      ask_price: float
      bid_size: float
      ask_size: float
      mark_iv: float            # æ ‡è®°éšå«æ³¢åŠ¨ç‡

  @dataclass
  class DRVerticalSpread:
      spread_id: str            # "BTC_103K-105K_10NOV25"
      lower_strike: float
      upper_strike: float
      expiry_timestamp: float
      lower_instrument: str
      upper_instrument: str
      lower_leg: DROption
      upper_leg: DROption
      min_liquidity: float      # min(lower_bid_size, upper_bid_size)
      avg_spread_pct: float     # å¹³å‡ä¹°å–ä»·å·®

  ä»·å·®ç”Ÿæˆè§„åˆ™ï¼š
  - åªç”Ÿæˆç›¸é‚»è¡Œæƒä»·çš„call spreadï¼ˆä¾‹å¦‚103K-105Kï¼Œä¸ç”Ÿæˆ103K-107Kï¼‰
  - åˆ°æœŸæ—¥å¿…é¡»ç›¸åŒ
  - æ¯ä¸ªåˆ°æœŸæ—¥æŒ‰è¡Œæƒä»·æ’åºï¼Œç”Ÿæˆæ‰€æœ‰ç›¸é‚»å¯¹

  è¿‡æ»¤æ¡ä»¶ï¼š
  - æŒä»“é‡ > 10 BTCï¼ˆå•legï¼‰
  - ä¹°å–ä»·å·® < 5%
  - å‰©ä½™åˆ°æœŸæ—¶é—´ï¼š1-30å¤©

  æ›´æ–°é¢‘ç‡ï¼šæ¯5åˆ†é’Ÿå…¨é‡æ‰«æ

  ---
  3.2 æ™ºèƒ½åŒ¹é…å¼•æ“ (Intelligent Matching Engine)

  3.2.1 åŒ¹é…ç®—æ³•

  è¾“å…¥ï¼š
  - PMé—®é¢˜åˆ—è¡¨ï¼ˆå·²è§£æï¼‰
  - DRå‚ç›´ä»·å·®åˆ—è¡¨ï¼ˆå·²ç”Ÿæˆï¼‰

  åŒ¹é…æ¡ä»¶ï¼ˆå…¨éƒ¨æ»¡è¶³æ‰åŒ¹é…ï¼‰ï¼š
  1. èµ„äº§åŒ¹é…ï¼šPMé—®é¢˜æ ‡çš„ä¸DRåˆçº¦æ ‡çš„ç›¸åŒï¼ˆBTCæˆ–ETHï¼‰
  2. è¡Œæƒä»·å®Œå…¨åŒ¹é…ï¼špm.strike == dr.lower_strikeï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
  3. åˆ°æœŸæ—¥åŒ¹é…ï¼š|pm.expiry - dr.expiry| < 24å°æ—¶
  4. æ–¹å‘åŒ¹é…ï¼šPM "above" â†’ DR call spread
  5. æµåŠ¨æ€§æ»¡è¶³ï¼šdr.min_liquidity >= 0.1 BTC

  è¾“å‡ºï¼š
  @dataclass
  class MatchedPair:
      pair_id: str              # "pm_0x123_dr_103_105_btc"
      asset: str                # "BTC" or "ETH"
      pm_question: PMQuestion
      dr_spread: DRVerticalSpread
      match_score: float        # 0-1ç»¼åˆè¯„åˆ†
      expected_roc: float       # å¿«é€Ÿä¼°ç®—çš„å¹´åŒ–æ”¶ç›Šç‡
      liquidity_score: float    # æµåŠ¨æ€§è¯„åˆ†
      created_at: float
      status: Literal["active", "queued", "expired", "low_liquidity"]

  3.2.2 è¯„åˆ†æ¨¡å‹

  è¯„åˆ†å…¬å¼ï¼š
  match_score = (
      liquidity_score * 0.6 +
      roc_score * 0.4
  )

  # æµåŠ¨æ€§è¯„åˆ† (0-1)
  liquidity_score = min(
      dr.min_liquidity / 1.0,  # å½’ä¸€åŒ–åˆ°1 BTC
      1.0
  ) * (1 - dr.avg_spread_pct / 5.0)  # ä»·å·®æƒ©ç½š

  # RoCè¯„åˆ† (0-1) - éœ€è¦å¿«é€ŸPhase1è®¡ç®—
  roc_score = min(expected_annual_roc / 0.5, 1.0)  # å½’ä¸€åŒ–åˆ°50%

  å¿«é€ŸRoCä¼°ç®—ï¼š
  - ä½¿ç”¨midä»·æ ¼ï¼ˆä¸è€ƒè™‘æ»‘ç‚¹ï¼‰å¿«é€Ÿè®¡ç®—Phase1
  - ä¸å®Œæ•´è®¡ç®—Phase2ï¼ˆä½¿ç”¨é»˜è®¤è´¹ç‡ä¼°ç®—ï¼‰
  - ç›®æ ‡ï¼š<100ms/pair

  ---
  3.3 åŠ¨æ€ç›‘æ§ç®¡ç† (Dynamic Monitor Management)

  3.3.1 ç›‘æ§å®ä¾‹ç®¡ç†å™¨

  èŒè´£ï¼š
  - ç»´æŠ¤æ´»è·ƒç›‘æ§å®ä¾‹åˆ—è¡¨ï¼ˆæœ€å¤š20ä¸ªï¼‰
  - æ ¹æ®ä¼˜å…ˆçº§åŠ¨æ€åˆ›å»º/é”€æ¯ç›‘æ§å®ä¾‹
  - å¤ç”¨WebSocketè¿æ¥ï¼Œä¼˜åŒ–è®¢é˜…

  æ•°æ®ç»“æ„ï¼š
  class PairMonitor:
      """å•ä¸ªPM-DRé…å¯¹çš„ç›‘æ§å®ä¾‹"""
      pair: MatchedPair
      deribit_ws: DeribitWebSocket
      polymarket_client: PolymarketClient
      synchronizer: MarketDataSynchronizer
      phase1_engine: Phase1Engine
      phase2_engine: Phase2Engine
      status: Literal["starting", "running", "stopping", "stopped"]

  åˆ›å»ºæµç¨‹ï¼š
  1. ä»matched_pairsä¸­é€‰æ‹©top Nï¼ˆæŒ‰match_scoreæ’åºï¼‰
  2. ä¸ºæ¯ä¸ªpairåˆ›å»ºPairMonitorå®ä¾‹
  3. è®¢é˜…DR WebSocket channelsï¼ˆ2ä¸ªoption legs + index + perpï¼‰
  4. å¯åŠ¨PMè½®è¯¢ä»»åŠ¡
  5. åˆ›å»ºDataSynchronizer
  6. çŠ¶æ€è®¾ä¸º"running"

  é”€æ¯æµç¨‹ï¼š
  1. åœæ­¢PMè½®è¯¢ä»»åŠ¡
  2. å–æ¶ˆè®¢é˜…DR WebSocket channels
  3. æ¸…ç†DataSynchronizerç¼“å­˜
  4. çŠ¶æ€è®¾ä¸º"stopped"
  5. ä»active_monitorsç§»é™¤

  æ›´æ–°ç­–ç•¥ï¼ˆæ¯60ç§’ï¼‰ï¼š
  # è·å–æœ€æ–°åŒ¹é…è¡¨ï¼ˆæŒ‰è¯„åˆ†æ’åºï¼‰
  sorted_pairs = get_matched_pairs(sort_by="match_score", limit=20)

  # å¯¹æ¯”å½“å‰ç›‘æ§åˆ—è¡¨
  current_pair_ids = set(active_monitors.keys())
  target_pair_ids = set([p.pair_id for p in sorted_pairs])

  # éœ€è¦ç§»é™¤çš„ï¼ˆä½ä¼˜å…ˆçº§æˆ–æ— æ•ˆï¼‰
  to_remove = current_pair_ids - target_pair_ids

  # éœ€è¦æ·»åŠ çš„ï¼ˆæ–°å‘ç°æˆ–ä¼˜å…ˆçº§æå‡ï¼‰
  to_add = target_pair_ids - current_pair_ids

  # æ‰§è¡Œåˆ›å»º/é”€æ¯
  for pair_id in to_remove:
      destroy_monitor(pair_id)

  for pair_id in to_add:
      create_monitor(pair_id)

  3.3.2 WebSocketè¿æ¥ä¼˜åŒ–

  é—®é¢˜ï¼š20ä¸ªé…å¯¹ Ã— 4ä¸ªchannels = 80ä¸ªè®¢é˜…ï¼Œå¯èƒ½è¶…é™

  è§£å†³æ–¹æ¡ˆï¼š
  - æ‰€æœ‰BTCç›‘æ§å…±äº«1ä¸ªWebSocketè¿æ¥
  - æ‰€æœ‰ETHç›‘æ§å…±äº«1ä¸ªWebSocketè¿æ¥
  - åŠ¨æ€ç®¡ç†è®¢é˜…åˆ—è¡¨ï¼š
  # å½“åˆ›å»ºæ–°ç›‘æ§æ—¶
  ws.subscribe([
      f"book.{lower_instrument}.raw",
      f"book.{upper_instrument}.raw"
  ])

  # å½“é”€æ¯ç›‘æ§æ—¶
  ws.unsubscribe([...])

  ---
  3.4 ç”Ÿå‘½å‘¨æœŸç®¡ç† (Lifecycle Management)

  3.4.1 çŠ¶æ€æ£€æŸ¥å™¨

  æ£€æŸ¥é¢‘ç‡ï¼šæ¯60ç§’

  æ£€æŸ¥é¡¹ç›®ï¼š

  | æ£€æŸ¥é¡¹         | æ¡ä»¶                                      | åŠ¨ä½œ
                  |
  |-------------|-----------------------------------------|-----------------
  ---------|
  | åˆ°æœŸæ£€æŸ¥        | now > expiry - 1å°æ—¶                      |
  æ ‡è®°ä¸º"expired"ï¼Œä»ç›‘æ§ç§»é™¤       |
  | æµåŠ¨æ€§æ£€æŸ¥       | min_liquidity < 0.05 BTC æˆ– spread > 10% |
  æ ‡è®°ä¸º"low_liquidity"ï¼Œé™ä½ä¼˜å…ˆçº§ |
  | å¸‚åœºçŠ¶æ€æ£€æŸ¥      | PM APIè¿”å›404 æˆ– DRåˆçº¦ä¸å­˜åœ¨                   |
  æ ‡è®°ä¸º"market_closed"ï¼Œç§»é™¤    |
  | WebSocketå¥åº· | è¶…è¿‡30ç§’æœªæ”¶åˆ°æ•°æ®                              |
  é‡è¿å¹¶é‡æ–°è®¢é˜…                  |

  3.4.2 è‡ªåŠ¨æ¸…ç†ç­–ç•¥

  ç«‹å³ç§»é™¤ï¼š
  - å·²åˆ°æœŸçš„é…å¯¹ï¼ˆexpiry < nowï¼‰
  - å¸‚åœºå…³é—­çš„é…å¯¹ï¼ˆ404é”™è¯¯ï¼‰

  å»¶è¿Ÿç§»é™¤ï¼ˆæ ‡è®°åè§‚å¯Ÿ10åˆ†é’Ÿï¼‰ï¼š
  - æµåŠ¨æ€§æš‚æ—¶æ¯ç«­ï¼ˆå¯èƒ½æ¢å¤ï¼‰
  - WebSocketè¿æ¥ä¸­æ–­ï¼ˆå¯èƒ½æ¢å¤ï¼‰

  å½’æ¡£ï¼š
  - å°†ç§»é™¤çš„é…å¯¹è®°å½•åˆ°logs/removed_pairs.csv
  - ä¿ç•™ç§»é™¤åŸå› å’Œæœ€åçŠ¶æ€

  ---
  3.5 ç»“æœèšåˆä¸è¾“å‡º (Results Aggregation)

  3.5.1 å®æ—¶Dashboard

  æ˜¾ç¤ºå†…å®¹ï¼š
  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â•â•â•â•—
  â•‘         Dashboard          [2025-11-10 10:05:23]
     â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â•â•â•â•£
  â•‘ ç³»ç»ŸçŠ¶æ€
     â•‘
  â•‘   Last Scan: 2åˆ†é’Ÿå‰ | PM Questions: 45 | DR Spreads: 156 | Matched: 32
   â•‘
  â•‘   Active Monitors: 20/20 | Queued: 12 | Expired: 3 | Low Liquidity: 2
   â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â•â•â•â•£
  â•‘ TOP 10 ç›‘æ§ä¸­çš„æœºä¼š
     â•‘
  â•Ÿâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â•¢
  â•‘ # â”‚ Asset â”‚ PM Question         â”‚ DR Spread  â”‚ RoC(å¹´) â”‚ Score â”‚ Status
   â•‘
  â•Ÿâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â•¢
  â•‘ 1  â”‚ BTC   â”‚ BTC>103K Nov10     â”‚ 103-105K   â”‚ 28.5%   â”‚ 0.92  â”‚ ğŸŸ¢ Live
   â•‘
  â•‘ 2  â”‚ BTC   â”‚ BTC>107K Nov10     â”‚ 107-110K   â”‚ 25.3%   â”‚ 0.88  â”‚ ğŸŸ¢ Live
   â•‘
  â•‘ 3  â”‚ ETH   â”‚ ETH>3200 Nov11     â”‚ 3200-3300  â”‚ 22.1%   â”‚ 0.85  â”‚ ğŸŸ¢ Live
   â•‘
  ...
  â•Ÿâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â•¢
  â•‘ ç­‰å¾…é˜Ÿåˆ— (æœªç›‘æ§)
     â•‘
  â•Ÿâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€
  â”€â”€â•¢
  â•‘ 21 â”‚ ETH   â”‚ ETH>3000 Nov12     â”‚ 3000-3100  â”‚ 11.8%   â”‚ 0.65  â”‚ â³
  Queueâ•‘
  ...
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â•â•â•â•

  3.5.2 CSVæ—¥å¿—

  ä¸»æ—¥å¿—ï¼ˆlogs/monitor_results.csvï¼‰ï¼š
  - æ¯ä¸ªMarketSnapshotç”Ÿæˆçš„Phase1/Phase2ç»“æœ
  - åŒ…å«pair_idã€timestampã€æ‰€æœ‰æŒ‡æ ‡

  åŒ¹é…æ—¥å¿—ï¼ˆlogs/matched_pairs.csvï¼‰ï¼š
  - æ¯æ¬¡æ‰«æåçš„å®Œæ•´åŒ¹é…è¡¨
  - åŒ…å«æ‰€æœ‰å‘ç°çš„é…å¯¹ï¼ˆç›‘æ§ä¸­+é˜Ÿåˆ—ä¸­ï¼‰

  ç”Ÿå‘½å‘¨æœŸæ—¥å¿—ï¼ˆlogs/lifecycle_events.csvï¼‰ï¼š
  - è®°å½•æ‰€æœ‰åˆ›å»ºã€ç§»é™¤ã€çŠ¶æ€å˜æ›´äº‹ä»¶
  timestamp, event_type, pair_id, reason, details
  2025-11-10 10:00:00, created, pm_0x123_dr_103_105, new_match, score=0.92
  2025-11-10 10:05:00, removed, pm_0x456_dr_100_103, expired, expiry_passed
  2025-11-10 10:10:00, priority_change, pm_0x789_dr_107_110, roc_increase,
  0.15â†’0.25

  ---
  4. æŠ€æœ¯æ–¹æ¡ˆ

  4.1 ç³»ç»Ÿæ¶æ„

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        é…ç½®å±‚ (Config)                           â”‚
  â”‚  config.yaml: èµ„äº§åˆ—è¡¨ã€è¿‡æ»¤æ¡ä»¶ã€é˜ˆå€¼ã€æƒé‡                    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  è‡ªåŠ¨å‘ç°æœåŠ¡ (Auto Discovery)                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚ PM Scanner       â”‚              â”‚ DR Scanner             â”‚  â”‚
  â”‚  â”‚ - Gamma APIæœç´¢  â”‚              â”‚ - è·å–æœŸæƒåˆçº¦åˆ—è¡¨     â”‚  â”‚
  â”‚  â”‚ - Questionè§£æ   â”‚              â”‚ - ç”Ÿæˆå‚ç›´ä»·å·®ç»„åˆ     â”‚  â”‚
  â”‚  â”‚ - è¿‡æ»¤ä¸ç¼“å­˜     â”‚              â”‚ - æµåŠ¨æ€§è¿‡æ»¤           â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
  â”‚                            â†“                                     â”‚
  â”‚                   data/pm_markets.json                           â”‚
  â”‚                   data/dr_spreads.json                           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  åŒ¹é…å¼•æ“ (Matching Engine)                      â”‚
  â”‚  - è¡Œæƒä»·/åˆ°æœŸæ—¥åŒ¹é…                                             â”‚
  â”‚  - æµåŠ¨æ€§éªŒè¯                                                    â”‚
  â”‚  - å¿«é€ŸRoCä¼°ç®—                                                   â”‚
  â”‚  - ç»¼åˆè¯„åˆ†æ’åº                                                  â”‚
  â”‚                            â†“                                     â”‚
  â”‚                   data/matched_pairs.json                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚              ç›‘æ§ç®¡ç†å™¨ (Monitor Manager)                        â”‚
  â”‚  - é€‰æ‹©top Né…å¯¹                                                 â”‚
  â”‚  - åŠ¨æ€åˆ›å»º/é”€æ¯ç›‘æ§å®ä¾‹                                         â”‚
  â”‚  - WebSocketè¿æ¥ç®¡ç†                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚              ç›‘æ§å®ä¾‹ (PairMonitor Ã— N)                          â”‚
  â”‚  æ¯ä¸ªå®ä¾‹:                                                       â”‚
  â”‚    DeribitWS â”€â”€â”€â”€â”                                               â”‚
  â”‚    PMClient â”€â”€â”€â”€â”€â”¤â”€â”€â†’ DataSync â”€â”€â†’ Phase1 â”€â”€â†’ Phase2 â”€â”€â†’ Resultâ”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                ç»“æœèšåˆå™¨ (Results Aggregator)                   â”‚
  â”‚  - æ”¶é›†æ‰€æœ‰ç›‘æ§å®ä¾‹çš„è¾“å‡º                                        â”‚
  â”‚  - å†™å…¥CSV                                                       â”‚
  â”‚  - æ›´æ–°Dashboard                                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
                    CSVæ—¥å¿— + ç»ˆç«¯Dashboard

  4.2 æ ¸å¿ƒæ¨¡å—å®ç°

  4.2.1 æ–°å¢æ¨¡å—

  | æ¨¡å—         | æ–‡ä»¶è·¯å¾„                          | ä¸»è¦ç±»/å‡½æ•°
       | èŒè´£                 |
  |------------|-------------------------------|----------------------|-----
  ---------------|
  | PMæ‰«æå™¨      | src/pm_market_scanner.py      | PMMarketScanner      |
  æœç´¢å’Œè§£æPMé—®é¢˜          |
  | DRæ‰«æå™¨      | src/dr_instrument_fetcher.py  | DRInstrumentFetcher  |
  è·å–DRæœŸæƒå¹¶ç”Ÿæˆä»·å·®        |
  | Questionè§£æ | src/question_parser.py        | QuestionParser       |
  ä»æ–‡æœ¬æå–strike/expiry |
  | åŒ¹é…å¼•æ“       | src/matching_engine.py        | MatchingEngine       |
  æ‰§è¡ŒåŒ¹é…å’Œè¯„åˆ†            |
  | ç›‘æ§ç®¡ç†å™¨      | src/monitor_manager.py        | MonitorManager       |
   ç®¡ç†ç›‘æ§å®ä¾‹             |
  | ç”Ÿå‘½å‘¨æœŸç®¡ç†     | src/lifecycle_manager.py      | LifecycleManager
  | å¥åº·æ£€æŸ¥å’Œæ¸…ç†            |
  | è‡ªåŠ¨å‘ç°æœåŠ¡     | src/auto_discovery_service.py | AutoDiscoveryService
  | åè°ƒæ‰«æå’ŒåŒ¹é…            |
  | ç»“æœèšåˆå™¨      | src/results_aggregator.py     | ResultsAggregator    |
   æ”¶é›†å’Œè¾“å‡ºç»“æœ            |

  4.2.2 ä¿®æ”¹çš„æ¨¡å—

  | æ¨¡å—                   | ä¿®æ”¹å†…å®¹                          |
  |----------------------|-------------------------------|
  | realtime_monitor.py  | é‡æ„ä¸ºå¤šå®ä¾‹æ¨¡å¼ï¼Œé›†æˆMonitorManager     |
  | config_manager.py    | æ–°å¢auto_discoveryé…ç½®æ®µçš„è§£æ        |
  | data_synchronizer.py | æ”¯æŒåŠ¨æ€é…ç½®instrumentï¼ˆä¸å†ä»configè¯»å–ï¼‰ |

  4.3 æ•°æ®æµ

  æ—¶åˆ»T=0ï¼ˆå¯åŠ¨ï¼‰:
    Config â†’ AutoDiscoveryService â†’ å®Œæ•´æ‰«æ
      â†’ MatchingEngine â†’ ç”ŸæˆåŒ¹é…è¡¨
      â†’ MonitorManager â†’ åˆ›å»ºtop 20ç›‘æ§å®ä¾‹
      â†’ æ¯ä¸ªPairMonitorå¼€å§‹è¿è¡Œ

  æ—¶åˆ»T=300sï¼ˆæ¯5åˆ†é’Ÿï¼‰:
    AutoDiscoveryService â†’ å¢é‡æ‰«æ
      â†’ æ£€æµ‹æ–°PMé—®é¢˜/æ–°DRåˆçº¦
      â†’ MatchingEngine â†’ æ›´æ–°åŒ¹é…è¡¨

  æ—¶åˆ»T=60s, 120s, ... ï¼ˆæ¯1åˆ†é’Ÿï¼‰:
    LifecycleManager â†’ æ£€æŸ¥æ‰€æœ‰é…å¯¹çŠ¶æ€
      â†’ æ ‡è®°expired/low_liquidity
      â†’ MonitorManager â†’ æ›´æ–°ç›‘æ§åˆ—è¡¨
      â†’ åˆ›å»º/é”€æ¯å¿…è¦çš„ç›‘æ§å®ä¾‹

  å®æ—¶ï¼ˆæ¯«ç§’çº§ï¼‰:
    æ¯ä¸ªPairMonitor â†’ DataSync â†’ MarketSnapshot
      â†’ Phase1 â†’ Phase2 â†’ FinalCalculator
      â†’ ResultsAggregator â†’ CSV + Dashboard

  4.4 é…ç½®æ–‡ä»¶

  # config/config.yaml

  auto_discovery:
    enabled: true

    # ç›‘æ§çš„èµ„äº§
    assets:
      - symbol: "BTC"
        enabled: true
      - symbol: "ETH"
        enabled: true

    # æ‰«æé¢‘ç‡
    scan_interval_sec: 300

    # Polymarketé…ç½®
    polymarket:
      min_volume_usd: 10000
      keywords:
        BTC: ["BTC", "Bitcoin", "$100K", "$110K", "100000", "110000"]
        ETH: ["ETH", "Ethereum", "$3K", "$5K", "3000", "5000"]
      question_patterns:
        - 'Will .* be above \$([0-9,]+) on (.+)\?'
        - '.* > \$([0-9,]+) by (.+)'
        - '.* above ([0-9,]+)K on (.+)'

    # Deribité…ç½®
    deribit:
      option_type: "call"
      min_expiry_days: 1
      max_expiry_days: 30
      min_open_interest: 10
      min_bid_size: 0.1
      max_spread_pct: 5.0

    # åŒ¹é…è§„åˆ™
    matching:
      expiry_tolerance_hours: 24
      strike_match_mode: "exact"
      adjacent_only: true
      scoring:
        liquidity_weight: 0.6
        roc_weight: 0.4

    # ç›‘æ§ç®¡ç†
    monitor:
      max_active_monitors: 20
      priority_metric: "match_score"
      update_interval_sec: 60
      lifecycle_check_interval_sec: 60
      auto_remove_expired: true
      auto_remove_low_liquidity: true

  # æ—¥å¿—é…ç½®
  logging:
    level: "INFO"
    monitor_results: "logs/monitor_results.csv"
    matched_pairs: "logs/matched_pairs.csv"
    lifecycle_events: "logs/lifecycle_events.csv"
    discovery_log: "logs/discovery.log"

  # æ•°æ®ç¼“å­˜
  cache:
    pm_markets: "data/pm_markets.json"
    dr_spreads: "data/dr_spreads.json"
    matched_pairs: "data/matched_pairs.json"

  ---
  5. å®æ–½è®¡åˆ’

  5.1 Phase 1: æ•°æ®è·å–å±‚ï¼ˆ0.5å¤©ï¼‰

  ç›®æ ‡ï¼šå®ç°PMå’ŒDRå¸‚åœºçš„è‡ªåŠ¨æ‰«æ

  | ä»»åŠ¡         | äº§å‡º                                        | æ—¶é—´   |
  |------------|-------------------------------------------|------|
  | DRåˆçº¦è·å–     | dr_instrument_fetcher.pyï¼Œè·å–å¹¶ç¼“å­˜æ‰€æœ‰BTC/ETHæœŸæƒ |
  1å¤©   |
  | DRä»·å·®ç”Ÿæˆ     | ç”Ÿæˆç›¸é‚»strikeçš„å‚ç›´ä»·å·®ç»„åˆï¼ŒåŒ…å«æµåŠ¨æ€§æ•°æ®
        | 0.5å¤© |
  | PMé—®é¢˜æ‰«æ     | pm_market_scanner.pyï¼Œå¤šå…³é”®è¯æœç´¢ç­–ç•¥             |
  1å¤©   |
  | Questionè§£æ | question_parser.pyï¼Œæ­£åˆ™æå–strike/expiryï¼Œå«æµ‹è¯•  |
  0.5å¤© |

  éªŒæ”¶æ ‡å‡†ï¼š
  - èƒ½å¤Ÿè·å–æ‰€æœ‰BTC/ETHçš„æ´»è·ƒæœŸæƒï¼ˆ>10ä¸ªï¼‰
  - ç”Ÿæˆæ‰€æœ‰ç›¸é‚»ä»·å·®ç»„åˆï¼ˆ>5ä¸ªï¼‰
  - èƒ½å¤Ÿä»PMæœç´¢åˆ°è‡³å°‘4ä¸ªBTCé—®é¢˜
  - Questionè§£æå‡†ç¡®ç‡ > 95%ï¼ˆäººå·¥éªŒè¯4ä¸ªæ ·æœ¬ï¼‰

  5.2 Phase 2: åŒ¹é…å¼•æ“ï¼ˆ0.5å¤©ï¼‰

  ç›®æ ‡ï¼šå®ç°æ™ºèƒ½åŒ¹é…å’Œè¯„åˆ†

  | ä»»åŠ¡      | äº§å‡º                          |
  |---------|-----------------------------|------|
  | åŒ¹é…ç®—æ³•    | matching_engine.pyï¼Œå®ç°äº”æ¡åŒ¹é…è§„åˆ™ | 
  | å¿«é€ŸRoCä¼°ç®— | é›†æˆPhase1å¿«é€Ÿè®¡ç®—ï¼ˆ<100ms/pairï¼‰   | 
  | è¯„åˆ†æ¨¡å‹    | å®ç°æµåŠ¨æ€§å’ŒRoCçš„ç»¼åˆè¯„åˆ†              |

  éªŒæ”¶æ ‡å‡†ï¼š
  - ä»5ä¸ªPMé—®é¢˜å’Œ5ä¸ªDRä»·å·®ä¸­æ‰¾åˆ°è‡³å°‘5ä¸ªæœ‰æ•ˆåŒ¹é…
  - è¯„åˆ†åˆç†æ€§äººå·¥éªŒè¯ï¼ˆtop 5ç¡®å®æ˜¯æœ€ä¼˜æœºä¼šï¼‰
  - å•æ¬¡åŒ¹é…è€—æ—¶ < 5ç§’ï¼ˆå…¨é‡ï¼‰

  5.3 Phase 3: ç›‘æ§ç®¡ç†ï¼ˆ0.5å¤©ï¼‰

  ç›®æ ‡ï¼šå®ç°åŠ¨æ€å¤šå¯¹ç›‘æ§

  | ä»»åŠ¡          | äº§å‡º                       | 
  |-------------|--------------------------|------|
  | ç›‘æ§å®ä¾‹å°è£…      | PairMonitorç±»ï¼Œå°è£…å•å¯¹ç›‘æ§é€»è¾‘    | 
  | ç›‘æ§ç®¡ç†å™¨       | MonitorManagerï¼ŒåŠ¨æ€åˆ›å»º/é”€æ¯å®ä¾‹ | 
  | WebSocketä¼˜åŒ– | å…±äº«è¿æ¥ï¼ŒåŠ¨æ€è®¢é˜…ç®¡ç†              | 
  | ç”Ÿå‘½å‘¨æœŸç®¡ç†      | LifecycleManagerï¼Œå¥åº·æ£€æŸ¥å’Œæ¸…ç† |

  éªŒæ”¶æ ‡å‡†ï¼š
  - èƒ½å¤ŸåŒæ—¶ç›‘æ§5ä¸ªPM-DRé…å¯¹
  - åŠ¨æ€æ·»åŠ /ç§»é™¤ç›‘æ§å®ä¾‹å·¥ä½œæ­£å¸¸
  - WebSocketè®¢é˜…æ•°åˆç†ï¼ˆ<50ä¸ªchannelsï¼‰
  - è‡ªåŠ¨ç§»é™¤åˆ°æœŸé…å¯¹

  5.4 Phase 4: é›†æˆä¸è¾“å‡ºï¼ˆ0.5å¤©ï¼‰

  ç›®æ ‡ï¼šå®Œæ•´çš„ç«¯åˆ°ç«¯æµç¨‹

  | ä»»åŠ¡     | äº§å‡º                                | 
  |--------|-----------------------------------|------|
  | è‡ªåŠ¨å‘ç°æœåŠ¡ | AutoDiscoveryServiceï¼Œåè°ƒæ‰€æœ‰ç»„ä»¶       | 
  | ç»“æœèšåˆå™¨  | ResultsAggregatorï¼ŒCSVå’ŒDashboardè¾“å‡º | 
  | ä¸»ç¨‹åºé‡æ„  | é‡å†™realtime_monitor.pyä¸ºè‡ªåŠ¨æ¨¡å¼        | 
  | é…ç½®æ–‡ä»¶   | å®Œæ•´çš„config.yamlæ¨¡æ¿å’Œæ–‡æ¡£               | 

  éªŒæ”¶æ ‡å‡†ï¼š
  - å¯åŠ¨å‘½ä»¤python realtime_monitor.py --autoèƒ½å¤Ÿå®Œå…¨è‡ªåŠ¨è¿è¡Œ
  - Dashboardå®æ—¶æ˜¾ç¤ºtop 20æœºä¼š
  - CSVæ—¥å¿—æ­£å¸¸è¾“å‡º
  - é…ç½®æ–‡ä»¶æ˜“äºç†è§£å’Œä¿®æ”¹

  5.5 Phase 5: æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ1å¤©ï¼‰

  ç›®æ ‡ï¼šç¡®ä¿ç¨³å®šæ€§å’Œæ€§èƒ½

  | ä»»åŠ¡   | äº§å‡º                     |
  |------|------------------------|------|
  | å•å…ƒæµ‹è¯• | æ¯ä¸ªæ¨¡å—çš„æµ‹è¯•è¦†ç›–ç‡ > 80%       | 
  | é›†æˆæµ‹è¯• | ç«¯åˆ°ç«¯æµ‹è¯•åœºæ™¯ï¼ˆå¯åŠ¨ã€è¿è¡Œ24hã€å´©æºƒæ¢å¤ï¼‰ |
  | æ€§èƒ½ä¼˜åŒ– | æ‰«æè€—æ—¶ã€å†…å­˜å ç”¨ã€CPUä½¿ç”¨ä¼˜åŒ–      | 

  éªŒæ”¶æ ‡å‡†ï¼š
  - æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
  - è¿ç»­è¿è¡Œ24å°æ—¶æ— å´©æºƒ
  - å†…å­˜å ç”¨ < 2GB
  - CPUä½¿ç”¨ç‡ < 50%ï¼ˆ5ä¸ªç›‘æ§å®ä¾‹ï¼‰

  ---
  6. é£é™©ä¸ç¼“è§£

  | é£é™©            | å½±å“          | æ¦‚ç‡  | ç¼“è§£æªæ–½                     |
   åº”æ€¥æ–¹æ¡ˆ             |
  |---------------|-------------|-----|--------------------------|----------
  --------|
  | PM APIé™æµ      | æ— æ³•æ‰«æ        | ä¸­   | å¢åŠ é‡è¯•å’Œexponential backoff
   | é™ä½æ‰«æé¢‘ç‡åˆ°10åˆ†é’Ÿ      |
  | Questionè§£æå¤±è´¥  | é—æ¼æœºä¼š        | é«˜   | å»ºç«‹æ­£åˆ™åº“ï¼ŒæŒç»­è¿­ä»£
          | äººå·¥æ ‡æ³¨å¤±è´¥æ ·æœ¬ï¼Œæ‰‹åŠ¨æ·»åŠ åˆ°é…ç½® |
  | WebSocketè®¢é˜…è¶…é™ | æ— æ³•ç›‘æ§æ‰€æœ‰pairs | ä¸­   | é™åˆ¶æœ€å¤§ç›‘æ§æ•°åˆ°20
          | åªç›‘æ§top 5        |
  | DRæ•°æ®ç¼ºå¤±        | åŒ¹é…å¤±è´¥        | ä½   | åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨ç¼“å­˜
         | æ‰‹åŠ¨ä¸‹è½½å¹¶å¯¼å…¥æ•°æ®æ–‡ä»¶      |
  | å†…å­˜æº¢å‡º          | ç³»ç»Ÿå´©æºƒ        | ä½   | é™åˆ¶ç¼“å­˜å¤§å°ï¼Œå®šæœŸæ¸…ç†
           | å¢åŠ æœåŠ¡å™¨å†…å­˜åˆ°16GB     |
  | æ–°PMé—®é¢˜æ ¼å¼       | è§£æå¤±è´¥        | ä¸­   |
  ç›‘æ§è§£æå¤±è´¥æ—¥å¿—ï¼Œå¿«é€Ÿæ·»åŠ æ–°è§„åˆ™         | æä¾›æ­£åˆ™é…ç½®æ–‡ä»¶ï¼Œæ— éœ€æ”¹ä»£ç 
  |

  ---
  7. éåŠŸèƒ½éœ€æ±‚

  7.1 æ€§èƒ½

  | æŒ‡æ ‡                | è¦æ±‚             |
  |-------------------|----------------|
  | å®Œæ•´æ‰«æå»¶è¿Ÿ            | < 30ç§’ï¼ˆå¯åŠ¨æ—¶ï¼‰     |
  | å¢é‡æ‰«æå»¶è¿Ÿ            | < 5ç§’ï¼ˆæ¯5åˆ†é’Ÿï¼‰     |
  | åŒ¹é…è®¡ç®—å»¶è¿Ÿ            | < 5ç§’ï¼ˆå…¨é‡ï¼‰       |
  | å•MarketSnapshotå»¶è¿Ÿ | < 2ç§’ï¼ˆå®æ—¶ç›‘æ§ï¼‰     |
  | å†…å­˜å ç”¨              | < 2GBï¼ˆ20ä¸ªç›‘æ§å®ä¾‹ï¼‰ |
  | CPUä½¿ç”¨ç‡            | < 50%ï¼ˆç¨³æ€è¿è¡Œï¼‰    |

  7.2 å¯é æ€§

  - ç³»ç»Ÿå¯ç”¨æ€§ï¼š>99%ï¼ˆæ’é™¤ç½‘ç»œæ•…éšœï¼‰
  - å´©æºƒæ¢å¤ï¼šé‡å¯åè‡ªåŠ¨åŠ è½½ç¼“å­˜ï¼Œ5åˆ†é’Ÿå†…æ¢å¤ç›‘æ§
  - æ•°æ®å®Œæ•´æ€§ï¼šæ‰€æœ‰CSVæ—¥å¿—append-onlyï¼Œæ— è¦†ç›–

  7.3 å¯ç»´æŠ¤æ€§

  - ä»£ç è´¨é‡ï¼šå•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
  - æ—¥å¿—å®Œæ•´æ€§ï¼šæ‰€æœ‰å…³é”®æ“ä½œï¼ˆæ‰«æã€åŒ¹é…ã€åˆ›å»º/é”€æ¯ç›‘æ§ï¼‰è®°å½•æ—¥å¿—
  - é…ç½®çµæ´»æ€§ï¼šæ‰€æœ‰é˜ˆå€¼å’Œæƒé‡å¯é€šè¿‡config.yamlè°ƒæ•´ï¼Œæ— éœ€æ”¹ä»£ç 

  7.4 å¯è§‚æµ‹æ€§

  - å®æ—¶Dashboardï¼šç»ˆç«¯æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€å’Œtopæœºä¼š
  - CSVæ—¥å¿—ï¼š3ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ˆç»“æœã€åŒ¹é…ã€ç”Ÿå‘½å‘¨æœŸï¼‰
  - PrometheusæŒ‡æ ‡ï¼ˆå¯é€‰ï¼‰ï¼š
    - pm_questions_discoveredï¼šå‘ç°çš„PMé—®é¢˜æ•°
    - dr_spreads_generatedï¼šç”Ÿæˆçš„DRä»·å·®æ•°
    - matched_pairs_totalï¼šåŒ¹é…çš„é…å¯¹æ•°
    - active_monitorsï¼šæ´»è·ƒç›‘æ§å®ä¾‹æ•°
    - scan_duration_secondsï¼šæ‰«æè€—æ—¶
    - matching_duration_secondsï¼šåŒ¹é…è€—æ—¶

  ---
  8. æˆåŠŸæ ‡å‡†

  | ç»´åº¦    | æ ‡å‡†                      | éªŒè¯æ–¹å¼          |
  |-------|-------------------------|---------------|
  | åŠŸèƒ½å®Œæ•´æ€§ | å®ç°æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼ˆæ‰«æã€åŒ¹é…ã€ç›‘æ§ã€ç”Ÿå‘½å‘¨æœŸï¼‰ |
  åŠŸèƒ½æµ‹è¯•checklist |
  | æœºä¼šè¦†ç›–ç‡ | å‘ç°å¹¶ç›‘æ§ > 90%çš„å¸‚åœºæœºä¼š        |
  äººå·¥å¯¹æ¯”PMç½‘ç«™å’Œç³»ç»Ÿè¾“å‡º |
  | è‡ªåŠ¨åŒ–ç¨‹åº¦ | é›¶æ‰‹åŠ¨é…ç½®ï¼ˆé™¤äº†åˆå§‹config.yamlï¼‰  | è¿è¡Œ7å¤©æ— éœ€äººå·¥å¹²é¢„
   |
  | å“åº”é€Ÿåº¦  | æ–°PMé—®é¢˜ä¸Šçº¿å5åˆ†é’Ÿå†…å¼€å§‹ç›‘æ§        | æ¨¡æ‹Ÿæµ‹è¯•          |
  | ç³»ç»Ÿç¨³å®šæ€§ | è¿ç»­è¿è¡Œ72å°æ—¶æ— å´©æºƒ             | å‹åŠ›æµ‹è¯•          |
  | æ•°æ®å‡†ç¡®æ€§ | Questionè§£æå‡†ç¡®ç‡ > 95%     | äººå·¥éªŒè¯10ä¸ªæ ·æœ¬    |

  ---
  9. æœªæ¥æ‰©å±•

  Phase 6ï¼ˆæœªæ¥ï¼‰ï¼šé«˜çº§åŠŸèƒ½

  - æ”¯æŒ"between"ç±»å‹é—®é¢˜ï¼šä¾‹å¦‚"BTC between $100K and $110K"
  - æ”¯æŒPUT spreadï¼šå½“PMé—®é¢˜æ˜¯"below"ç±»å‹
  - è·¨å¹³å°å¥—åˆ©ï¼šæ·»åŠ å…¶ä»–æœŸæƒå¹³å°ï¼ˆå¦‚Bybitã€OKXï¼‰
  - MLä¼˜åŒ–è¯„åˆ†ï¼šä½¿ç”¨å†å²æ•°æ®è®­ç»ƒé¢„æµ‹æ¨¡å‹
  - Telegramå‘Šè­¦ï¼štopæœºä¼šRoCçªç ´é˜ˆå€¼æ—¶æ¨é€é€šçŸ¥
  - è‡ªåŠ¨æ‰§è¡Œï¼šé›†æˆæ‰§è¡Œå¼•æ“ï¼Œè‡ªåŠ¨ä¸‹å•ï¼ˆéœ€è¦é£æ§å®¡æ‰¹ï¼‰

  ---
  é™„å½•

  A. æ•°æ®ç»“æ„å®Œæ•´å®šä¹‰

  è§4.3èŠ‚æŠ€æœ¯æ–¹æ¡ˆ

  B. APIç«¯ç‚¹

  Polymarketï¼š
  - Gamma API:
  https://gamma-api.polymarket.com/public-search?query={keyword}
  - CLOB API: https://clob.polymarket.com/book?token_id={token_id}

  Deribitï¼š
  - Instruments:
  /public/get_instruments?currency={BTC|ETH}&kind=option&expired=false
  - Orderbook: WebSocket book.{instrument}.raw

  C. æ–‡ä»¶ç»“æ„

  PM-DR/
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ pm_market_scanner.py       # æ–°å¢
  â”‚   â”œâ”€â”€ dr_instrument_fetcher.py   # æ–°å¢
  â”‚   â”œâ”€â”€ question_parser.py         # æ–°å¢
  â”‚   â”œâ”€â”€ matching_engine.py         # æ–°å¢
  â”‚   â”œâ”€â”€ monitor_manager.py         # æ–°å¢
  â”‚   â”œâ”€â”€ lifecycle_manager.py       # æ–°å¢
  â”‚   â”œâ”€â”€ auto_discovery_service.py  # æ–°å¢
  â”‚   â”œâ”€â”€ results_aggregator.py      # æ–°å¢
  â”‚   â”œâ”€â”€ realtime_monitor.py        # é‡æ„
  â”‚   â””â”€â”€ ... (ç°æœ‰æ¨¡å—)
  â”œâ”€â”€ data/                          # æ–°å¢ç›®å½•
  â”‚   â”œâ”€â”€ pm_markets.json
  â”‚   â”œâ”€â”€ dr_spreads.json
  â”‚   â””â”€â”€ matched_pairs.json
  â”œâ”€â”€ logs/
  â”‚   â”œâ”€â”€ monitor_results.csv
  â”‚   â”œâ”€â”€ matched_pairs.csv
  â”‚   â”œâ”€â”€ lifecycle_events.csv
  â”‚   â””â”€â”€ discovery.log
  â”œâ”€â”€ config/
  â”‚   â””â”€â”€ config.yaml                # æ‰©å±•
  â””â”€â”€ tests/
      â”œâ”€â”€ test_pm_scanner.py         # æ–°å¢
      â”œâ”€â”€ test_matching_engine.py    # æ–°å¢
      â””â”€â”€ ...
